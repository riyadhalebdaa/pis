<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>School Display</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
  font-family:Arial;
  background:#000;
  overflow:hidden;
  visibility:hidden;
}

/* LOADING */
#loadingScreen{
position:fixed;top:0;left:0;width:100%;height:100%;
background:#000;color:#fff;display:flex;
flex-direction:column;justify-content:center;align-items:center;
font-size:28px;z-index:2000;direction:rtl;
transition:opacity .8s ease;
}
#progressContainer{width:400px;height:20px;background:#333;margin-top:25px;border-radius:10px;overflow:hidden;}
#progressBar{height:100%;width:0%;background:#00c853;transition:width .3s;}
#progressText{margin-top:15px;font-size:22px;}

/* VIDEO */
#bgVideo{
position:fixed;top:0;left:0;
width:100vw;height:100vh;
object-fit:cover;
z-index:-1;
opacity:0;
transition:opacity 1.2s ease;
}

/* SLIDER */
.slider{
position:fixed;width:100%;height:100%;
z-index:-2;
opacity:1;
transition:opacity 1.2s ease;
}
.slide{
position:absolute;width:100%;height:100%;
object-fit:cover;opacity:0;
transition:opacity 1.5s ease-in-out;
}
.slide.active{opacity:1;}

/* LOGO */
.logo-container{
position:absolute;top:20px;right:30px;
background:#fff;padding:15px 40px;
border-radius:20px;box-shadow:0 10px 25px rgba(0,0,0,.08);
z-index:10;
}
.logo-container img{height:70px;}

/* CLOCK */
.clock{
position:absolute;top:40px;left:40px;
width:240px;height:240px;border-radius:50%;
background:rgba(255,255,255,.5);
backdrop-filter:blur(6px);
border:6px solid rgba(0,0,0,.75);
box-shadow:0 0 0 6px rgba(255,255,255,.6),0 15px 35px rgba(0,0,0,.25);
display:flex;justify-content:center;align-items:center;
z-index:5;
}
.center{position:absolute;width:16px;height:16px;background:#000;border-radius:50%;z-index:10;}
.clock-logo{
position:absolute;
width:50px;
z-index:2;
top:30%;
left:50%;
transform:translate(-50%,-50%);
pointer-events:none;
}
.hand{position:absolute;bottom:50%;transform-origin:bottom;border-radius:10px;z-index:5;}
.hour{width:7px;height:65px;background:#111;}
.minute{width:4px;height:95px;background:#333;}
.second{width:2px;height:105px;background:#d40000;}
.number{position:absolute;font-size:22px;font-weight:500;color:#111;transform:translate(-50%,-50%);z-index:6;}
.number.bold{font-weight:800;font-size:29px;}
.tick{position:absolute;width:3px;height:7px;background:#222;top:5px;left:49%;transform-origin:50% 110px;}
.tick.small{height:3px;width:2px;background:#555;}

/* STATUS */
.status{
position:absolute;bottom:40px;right:40px;
background:rgba(255,255,255,.95);
padding:18px 35px;border-radius:15px;
font-size:22px;font-weight:bold;
box-shadow:0 10px 25px rgba(0,0,0,.15);
display:none;direction:rtl;z-index:5;
}

/* DATE */
.date-box{
position:absolute;bottom:40px;left:40px;
background:rgba(255,255,255,.95);
padding:18px 30px;border-radius:15px;
font-size:20px;font-weight:bold;
box-shadow:0 10px 25px rgba(0,0,0,.15);
direction:rtl;z-index:5;
}

/* OVERLAY */
.overlay{
position:fixed;top:0;left:0;width:100%;height:100%;
background:rgba(0,0,0,.65);
display:flex;justify-content:center;align-items:center;
color:#fff;font-size:46px;font-weight:bold;
opacity:0;visibility:hidden;
transition:opacity .6s ease;
z-index:999;
}
.overlay.show{opacity:1;visibility:visible;}
</style>
</head>
<body>

<video id="bgVideo" autoplay muted loop playsinline>
<source src="video/rc.mp4" type="video/mp4">
</video>

<div id="loadingScreen">
<div>‚è≥ ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑŸÜÿ∏ÿßŸÖ...</div>
<div id="progressContainer"><div id="progressBar"></div></div>
<div id="progressText">0%</div>
</div>

<div class="logo-container"><img src="logo.png"></div>
<div class="slider" id="slider"></div>

<div class="clock">
<img src="logo_without_texts.png" class="clock-logo">
<div class="hand hour"></div>
<div class="hand minute"></div>
<div class="hand second"></div>
<div class="center"></div>
</div>

<div class="status" id="statusBox"></div>
<div class="date-box" id="dateBox"></div>
<div class="overlay" id="overlay"></div>

<script>

/* =========================
   ÿ™ÿ¨ŸáŸäÿ≤ ÿ£ÿµŸàÿßÿ™ ÿßŸÑÿ≠ÿµÿµ
========================= */

const lessonSounds = {
  "ÿßŸÑÿ≠ÿµÿ© ÿßŸÑÿ£ŸàŸÑŸâ": new Audio("audio/00.MP3"),
  "ÿßŸÑÿ≠ÿµÿ© ÿßŸÑÿ´ÿßŸÜŸäÿ©": new Audio("audio/01.MP3"),
  "ÿßŸÑÿ≠ÿµÿ© ÿßŸÑÿ´ÿßŸÑÿ´ÿ©": new Audio("audio/02.MP3"),
  "ÿßŸÑÿ≠ÿµÿ© ÿßŸÑÿ±ÿßÿ®ÿπÿ©": new Audio("audio/03.MP3"),
  "ÿßŸÑÿ≠ÿµÿ© ÿßŸÑÿÆÿßŸÖÿ≥ÿ©": new Audio("audio/04.MP3"),
  "ÿßŸÑÿ≠ÿµÿ© ÿßŸÑÿ≥ÿßÿØÿ≥ÿ©": new Audio("audio/05.MP3"),
  "ÿ£ÿØÿßÿ° ÿµŸÑÿßÿ© ÿßŸÑÿ∏Ÿáÿ±": new Audio("audio/06.MP3")
};

Object.values(lessonSounds).forEach(a => {
  a.preload = "auto";
});


/* CLOCK */
const hour=document.querySelector(".hour");
const minute=document.querySelector(".minute");
const second=document.querySelector(".second");
const clock=document.querySelector(".clock");
const nums=["Ÿ°","Ÿ¢","Ÿ£","Ÿ§","Ÿ•","Ÿ¶","Ÿß","Ÿ®","Ÿ©","Ÿ°Ÿ†","Ÿ°Ÿ°","Ÿ°Ÿ¢"];
for(let i=1;i<=12;i++){
let n=document.createElement("div");
n.className="number";
if([3,6,9,12].includes(i))n.classList.add("bold");
n.textContent=nums[i-1];
let angle=i*30*Math.PI/180;
let r=87;
n.style.left=113+r*Math.sin(angle)+"px";
n.style.top=116-r*Math.cos(angle)+"px";
clock.appendChild(n);
}
for(let i=0;i<60;i++){
let t=document.createElement("div");
t.className="tick"+(i%5?" small":"");
t.style.transform=`rotate(${i*6}deg)`;
clock.appendChild(t);
}
function updateClock(){
let d=new Date();
hour.style.transform=`rotate(${(d.getHours()%12)*30+d.getMinutes()*.5}deg)`;
minute.style.transform=`rotate(${d.getMinutes()*6}deg)`;
second.style.transform=`rotate(${d.getSeconds()*6}deg)`;
}
setInterval(updateClock,1000);updateClock();

/* DATE */
function toArabicDigits(s){return s.replace(/\d/g,d=>"Ÿ†Ÿ°Ÿ¢Ÿ£Ÿ§Ÿ•Ÿ¶ŸßŸ®Ÿ©"[d]);}
function updateDate(){
let d=new Date();
let days=["ÿßŸÑÿ£ÿ≠ÿØ","ÿßŸÑÿßÿ´ŸÜŸäŸÜ","ÿßŸÑÿ´ŸÑÿßÿ´ÿßÿ°","ÿßŸÑÿ£ÿ±ÿ®ÿπÿßÿ°","ÿßŸÑÿÆŸÖŸäÿ≥","ÿßŸÑÿ¨ŸÖÿπÿ©","ÿßŸÑÿ≥ÿ®ÿ™"];
let hijri=new Intl.DateTimeFormat("ar-SA-u-ca-islamic",{day:"numeric",month:"long",year:"numeric"}).format(d);
hijri=hijri.replace(/\s?ŸáŸÄ/,"").trim()+"ŸáŸÄ";
let greg=new Intl.DateTimeFormat("ar-EG",{day:"numeric",month:"long",year:"numeric"}).format(d);
dateBox.innerHTML = `
<div>${days[d.getDay()]} ${toArabicDigits(hijri)}</div>
<div style="margin-top:8px;">ÿßŸÑŸÖŸàÿßŸÅŸÇ ${toArabicDigits(greg)}ŸÖ</div>
`;
}
updateDate();setInterval(updateDate,60000);

/* SCHEDULE */
function toMin(t){let[a,b]=t.split(":").map(Number);return a*60+b;}
const schedule=[
{name:"ÿßŸÑÿ≠ÿµÿ© ÿßŸÑÿ£ŸàŸÑŸâ",start:"09:00",end:"09:35"},
{name:"ÿßŸÑÿ≠ÿµÿ© ÿßŸÑÿ´ÿßŸÜŸäÿ©",start:"09:35",end:"10:10"},
{name:"ÿßŸÑÿ≠ÿµÿ© ÿßŸÑÿ´ÿßŸÑÿ´ÿ©",start:"10:10",end:"10:45"},
{name:"ÿßŸÑÿ≠ÿµÿ© ÿßŸÑÿ±ÿßÿ®ÿπÿ©",start:"10:45",end:"11:20"},
{name:"ÿßŸÑÿ≠ÿµÿ© ÿßŸÑÿÆÿßŸÖÿ≥ÿ©",start:"11:20",end:"11:55"},
{name:"ÿßŸÑÿ≠ÿµÿ© ÿßŸÑÿ≥ÿßÿØÿ≥ÿ©",start:"11:55",end:"12:30"},
{name:"ÿ£ÿØÿßÿ° ÿµŸÑÿßÿ© ÿßŸÑÿ∏Ÿáÿ±",start:"12:30",end:"12:45"}
];

let lastEvent="";
let prevEvent=null;

function getCurrent(c){return schedule.find(e=>c>=toMin(e.start)&&c<toMin(e.end));}

function checkSchedule(){
let now=new Date();
let current=now.getHours()*60+now.getMinutes();
let currentEvent=getCurrent(current);
let currentName=currentEvent?currentEvent.name:"";
let today=now.getDay();
let blocked=[5,6];

if(currentEvent){
statusBox.style.display="block";
statusBox.innerHTML=`üü¢ ÿßŸÑÿ¢ŸÜ ${currentEvent.name}`;
}else statusBox.style.display="none";

if(currentName!==lastEvent && currentEvent){
if(!blocked.includes(today)){
overlay.innerHTML=`üü¢ ÿ™ÿ®ÿØÿ£ ÿßŸÑÿ¢ŸÜ ${currentEvent.name}`;
overlay.classList.add("show");

/* ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿµŸàÿ™ */
const sound = lessonSounds[currentEvent.name];
if(sound){
  sound.currentTime = 0;
  sound.play().catch(()=>{});
}

setTimeout(()=>{
  overlay.classList.remove("show");
},12000);
}
lastEvent=currentName;
}
prevEvent=currentEvent;
}
setInterval(checkSchedule,1000);checkSchedule();

/* SLIDER */
const slider = document.getElementById("slider");

const totalImages = 300;
let currentIndex = 1;

let img1 = document.createElement("img");
let img2 = document.createElement("img");

img1.className = "slide active";
img2.className = "slide";

slider.appendChild(img1);
slider.appendChild(img2);

function getImagePath(index){
  return `preimg/Slide${index}.JPG`;
}

img1.src = getImagePath(currentIndex);

function nextSlide(){

  let nextIndex = currentIndex + 1;
  if(nextIndex > totalImages) nextIndex = 1;

  img2.src = getImagePath(nextIndex);

  img2.onload = () => {

    img2.classList.add("active");
    img1.classList.remove("active");

    // swap
    [img1, img2] = [img2, img1];
    currentIndex = nextIndex;

  };

}

setInterval(nextSlide, 5000);

/* VIDEO SCHEDULE + FADE */
function checkVideo(){
let now=new Date();
let day=now.getDay();
let min=now.getHours()*60+now.getMinutes();
let start=21*60+20,end=24*60;
let allowed=[0,1,2,3];

if(allowed.includes(day)&&min>=start&&min<end){
bgVideo.style.opacity=1;
slider.style.opacity=0;
bgVideo.play();
}else{
bgVideo.style.opacity=0;
slider.style.opacity=1;
bgVideo.pause();
}
}
setInterval(checkVideo,30000);
checkVideo();


/* =========================
   LOADING SYSTEM
========================= */

window.addEventListener("load", () => {

   document.body.style.visibility = "visible";

  const loading = document.getElementById("loadingScreen");
  const progressBar = document.getElementById("progressBar");
  const progressText = document.getElementById("progressText");

  const firstImagesCount = 5;

  const audioFiles = [
    "00.MP3",
    "01.MP3",
    "02.MP3",
    "03.MP3",
    "04.MP3",
    "05.MP3",
    "06.MP3"
  ];

  let filesToLoad = [];
  let loaded = 0;

  /* ÿ£ŸàŸÑ 5 ÿµŸàÿ± */
  for (let i = 1; i <= firstImagesCount; i++) {
    filesToLoad.push(`preimg/Slide${i}.JPG`);
  }

  /* ŸÉŸÑ ÿßŸÑÿ£ÿµŸàÿßÿ™ */
  audioFiles.forEach(file => {
    filesToLoad.push(`audio/${file}`);
  });

  const totalFiles = filesToLoad.length;

  function updateProgress() {

    loaded++;
    const percent = Math.floor((loaded / totalFiles) * 100);

    progressBar.style.width = percent + "%";
    progressText.textContent = percent + "%";

    if (loaded >= totalFiles) {

      setTimeout(() => {
        loading.style.opacity = "0";
        setTimeout(() => {
          loading.style.display = "none";
        }, 800);
      }, 400);

    }
  }

  filesToLoad.forEach(src => {

    if (src.includes("preimg")) {

      const img = new Image();
      img.src = src;
      img.onload = updateProgress;
      img.onerror = updateProgress;

    } else {

      const audio = new Audio();
      audio.src = src;
      audio.preload = "auto";
      audio.oncanplaythrough = updateProgress;
      audio.onerror = updateProgress;

    }

  });

});

</script>
</body>
</html>